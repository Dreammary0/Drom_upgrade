<!DOCTYPE HTML>
<html>
<head>
    <link rel="stylesheet" type="text/css" href="/static/css/style.css"/>
    <link rel="stylesheet" type="text/css" href="/static/css/footer.css"/>
    <link rel="icon" href="/static/images/favicon.png">
    <title> –¢–∏–ø–∞ –¥—Ä–æ–º–∞ - —Ü–µ–Ω—ã –Ω–∞ –∞–≤—Ç–æ–º–æ–±–∏–ª–∏ </title>
</head>

<script type="text/javascript">
    // –§–æ—Ä–º–∏—Ä—É–µ–º —Å–ª–æ–≤–∞—Ä—å –º–æ–¥–µ–ª–µ–π
    let modelNames = {};
    {% for iter, row in iterrows(brands) %}
        modelNames['{{ row['BrandName'] }}'] = '';
    {% endfor %}
    {% for iter, row in iterrows(models) %}
        modelNames['{{ row['BrandName'] }}'] += '{{ row['ModelName'] }},';
    {% endfor %}
    {% for iter, row in iterrows(brands) %}
        modelNames['{{ row['BrandName'] }}'] = modelNames['{{ row['BrandName'] }}'].slice(0, -1);
    {% endfor %}
    // —Ñ-—Ü–∏—è, –≤–æ–∑–≤—Ä–∞—â–∞—é—â–∞—è –º–∞—Å—Å–∏–≤ –º–æ–¥–µ–ª–µ–π –ø–æ –∑–∞–¥–∞–Ω–Ω–æ–º—É –±—Ä–µ–Ω–¥—É
    function getModelByBrand(selected) {
        let foundModels = modelNames[selected];
        return foundModels.split(","); // –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ–º —Å—Ç—Ä–æ–∫—É –≤ –º–∞—Å—Å–∏–≤ –≥–æ—Ä–æ–¥–æ–≤
    }

    // —Ñ-—Ü–∏—è, –≤—ã–≤–æ–¥—è—â–∞—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ —Å–ø–∏—Å–æ–∫ –≥–æ—Ä–æ–¥–æ–≤
    function MkModels(selected) {
        if (selected === "–õ—é–±–∞—è –º–∞—Ä–∫–∞") {
            let modelsList = document.forms["filter"].elements["model"];
            document.forms["filter"].elements["model"].disabled = true;
            modelsList.length = 0; // —É–¥–∞–ª—è–µ–º –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã –∏–∑ —Å–ø–∏—Å–∫–∞ –º–æ–¥–µ–ª–µ–π
            if (document.createElement) {
                let newModelListOption = document.createElement("OPTION");
                newModelListOption.text = "–ú–æ–¥–µ–ª—å";
                newModelListOption.value = "";
                // —Ç—É—Ç –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —ç–ª–µ–º–µ–Ω—Ç–∞ –ª–∏–±–æ –º–µ—Ç–æ–¥ IE, –ª–∏–±–æ DOM
                (modelsList.options.add) ? modelsList.options.add(newModelListOption) : modelsList.add(newModelListOption, null);
            }
        } else {
            let currModels = getModelByBrand(selected);
            let currModelsCount = currModels.length;
            let modelsList = document.forms["filter"].elements["model"];
            let modelsListOptionsCnt = modelsList.options.length;
            modelsList.length = 0; // —É–¥–∞–ª—è–µ–º –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã –∏–∑ —Å–ø–∏—Å–∫–∞ –º–æ–¥–µ–ª–µ–π
            if (document.createElement) {
                let newModelListOption = document.createElement("OPTION");
                newModelListOption.text = "–õ—é–±–∞—è –º–æ–¥–µ–ª—å";
                newModelListOption.value = "";
                // —Ç—É—Ç –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —ç–ª–µ–º–µ–Ω—Ç–∞ –ª–∏–±–æ –º–µ—Ç–æ–¥ IE, –ª–∏–±–æ DOM
                (modelsList.options.add) ? modelsList.options.add(newModelListOption) : modelsList.add(newModelListOption, null);
            } else {
                // –¥–ª—è NN3.x-4.x
                modelsList.options[i] = new Option(currModels[i], currModels[i], false, false);
            }
            for (let i = 0; i < currModelsCount; i++) {
                // –¥–∞–ª–µ–µ –º—ã –¥–æ–±–∞–≤–ª—è–µ–º –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –º–æ–¥–µ–ª–∏ –≤ —Å–ø–∏—Å–æ–∫
                if (document.createElement) {
                    let newModelListOption = document.createElement("OPTION");
                    newModelListOption.text = currModels[i];
                    newModelListOption.value = currModels[i];
                    if (newModelListOption.value === '{{ model }}') {
                        newModelListOption.selected = 'selected';
                    }
                    // —Ç—É—Ç –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —ç–ª–µ–º–µ–Ω—Ç–∞ –ª–∏–±–æ –º–µ—Ç–æ–¥ IE, –ª–∏–±–æ DOM
                    (modelsList.options.add) ? modelsList.options.add(newModelListOption) : modelsList.add(newModelListOption, null);
                } else {
                    // –¥–ª—è NN3.x-4.x
                    modelsList.options[i] = new Option(currModels[i], currModels[i], false, false);
                }
            }
            document.forms["filter"].elements["model"].disabled = false;
        }
    }

    // –∏–Ω–∏—Ü–∏–∏—Ä—É–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤ —Å–ø–∏—Å–∫–µ –º–æ–¥–µ–ª–µ–π, –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–µ–∫—É—â–µ–≥–æ –±—Ä–µ–Ω–¥–∞
    window.onload = function () {
        MkModels(document.forms["filter"].elements["brand"].options[document.forms["filter"].elements["brand"].selectedIndex].text);
    };
    //-->
</script>

<body>

<div class="menu">
    <ul>
        <li style="height: 50px; padding: 0; margin: 0;background-color: black;">
            <a href="{{ url_for("index") }}" style="padding: 0; margin: 0;">
                <img src="/static/images/logo.png" style="padding: 0; margin: 0; height: 48px;">
            </a>
        </li>

        {#        –í—ã–ø–∞–¥–∞—é—â–∏–π —Å–ø–∏—Å–æ–∫ –≤—ã–±–æ—Ä–∞ –≥–æ—Ä–æ–¥–∞#}
        <select style="background-color: black; color: white; border: none; outline: none;
         cursor: pointer; height: 50px; font-size: 14.5px; margin-left: 5px;"
                onchange="sendRequest()" id="city" name="city">
            <option value="–í—Å–µ —Ä–µ–≥–∏–æ–Ω—ã">–í—Å–µ —Ä–µ–≥–∏–æ–Ω—ã</option>
            {% for iter, row in iterrows(cities) %}
                <option value="{{ row['CityName'] }}"
                        {% if row['CityName']==selected_city %}selected{% endif %}>
                    {{ row['CityName'] }}
                </option>
            {% endfor %}
        </select>

        <script>
            function sendRequest() {
                var selectedCity = document.getElementById("city").value;
                window.location.href = "http://127.0.0.1:5000/?city=" + selectedCity;
            }
        </script>


        {% if not user_id %}
            <li style="float: right; background-color: black;">
                <a style="color: #cccccc;" href={{ url_for("login") }}>–ê–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è</a>
            </li>
        {% else %}
            <li style="float: right; background-color: black;">
                <a style="color: #cccccc;" href={{ url_for("logout") }}>–í—ã–π—Ç–∏</a>
            </li>
            <li style="float: right; background-color: black;">
                <a style="color: #cccccc;" href={{ url_for("account") }}>–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç</a>
            </li>

        {% endif %}
        <li style="float: right;"><a href={{ url_for("new_selling") }}><b>&#10753;</b> –ü–æ–¥–∞—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏–µ</a></li>
    </ul>
</div>
<div class='wrapper'>

    <div class="content-container" style="padding-bottom: 100px;">
        <h1>–ü–æ–∏—Å–∫ –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π</h1>
        <form class="filter" method="get" name="filter">
            <select name="brand" onchange="MkModels(this.options[this.selectedIndex].text);">
                <option selected disabled hidden>–ú–∞—Ä–∫–∞</option>
                <option value="">–õ—é–±–∞—è –º–∞—Ä–∫–∞</option>
                {% for iter, row in iterrows(brands) %}
                    <option value="{{ row['BrandName'] }}"
                            {% if row['BrandName']==brand %}selected{% endif %}>
                        {{ row['BrandName'] }}
                    </option>
                {% endfor %}
            </select>

            <select name="model" disabled>
                <option selected disabled hidden>–ú–æ–¥–µ–ª—å</option>
            </select>


            <input type="number" placeholder="–¶–µ–Ω–∞ –æ—Ç, ‚ÇΩ" min=0
                   class="from" name="minprice" value={{ min_price }}>
            <input type="number" placeholder="–¥–æ" min=0
                   class="to" name="maxprice" value={{ max_price }}>

            <input type="number" placeholder="–ì–æ–¥ –æ—Ç" min=1940 max=2023
                   class="from" name="minyear" value={{ min_year }}>
            <input type="number" placeholder="–¥–æ" min=1940 max=2023
                   class="to" name="maxyear" value={{ max_year }}>

            <select name="transmission">
                <option selected disabled hidden>–ö–ü–ü</option>
                <option value="">–õ—é–±–∞—è –ö–ü–ü</option>
                {% for iter, row in iterrows(transmissions) %}
                    <option value={{ row['TransmissionType'] }}
                                    {% if row['TransmissionType']==transmission %}selected{% endif %}>
                        {{ row['TransmissionType'] }}
                    </option>
                {% endfor %}
            </select>

            <select name="drive">
                <option selected disabled hidden>–ü—Ä–∏–≤–æ–¥</option>
                <option value="">–õ—é–±–æ–π –ø—Ä–∏–≤–æ–¥</option>
                {% for iter, row in iterrows(drives) %}
                    <option value={{ row['DriveType'] }}
                                    {% if row['DriveType']==drive %}selected{% endif %}>
                        {{ row['DriveType'] }}
                    </option>
                {% endfor %}
            </select>

            <input type="number" placeholder="–ú–æ—â–Ω–æ—Å—Ç—å –æ—Ç" min=0 max=2000 step=1
                   class="from" name="minhp" value={{ min_hp }}>
            <input type="number" placeholder="–¥–æ" min=0 max=2000 step=1
                   class="to" name="maxhp" value={{ max_hp }}>
            <input type="submit" value="–ü–æ–∫–∞–∑–∞—Ç—å">
        </form>

        {#–í—ã–≤–æ–¥ –±—Ä–µ–Ω–¥–æ–≤ —Å–∏–º–ø–∞—Ç–∏—á–Ω—ã–º —Å–ø–∏—Å–∫–æ–º, –±–µ—Å–ø–æ–ª–µ–∑–Ω–∞—è —Ç—Ä–∞—Ç–∞ –º–µ—Å—Ç–∞((( #}
        {#    {% if not (brand or model or min_price or max_price#}
        {#            or min_year or max_price or transmission or drive) or#}
        {#            (model and not brand) %}#}
        {#        <form>#}
        {#            <ul class="ul_brands">#}
        {#                {% for iter, row in iterrows(brands) %}#}
        {#                    <li>#}
        {#                        <a><input type="submit" name="brand" class="brands"#}
        {#                                  value="{{ row['BrandName'] }}" style="all: unset;"></a>#}
        {#                    </li>#}
        {#                {% endfor %}#}
        {#            </ul>#}
        {#        </form>#}
        {#    {% endif %}#}

        {% if len(df_selling)!=0 %}
            <h2>–û–±—ä—è–≤–ª–µ–Ω–∏–π –Ω–∞–π–¥–µ–Ω–æ: {{ int(len(df_selling)) }}</h2>
            <hr style="width: 1097px; margin-left: 0;">
            {% for iter, row in iterrows(df_selling) %}
                <div class="selling">
                    {# –¢–∞–±–ª–∏—Ü–∞ –∫–∞–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä, –≤ –Ω–µ–π –µ—â–µ 3 —Ç–∞–±–ª–∏—Ü—ã - –∫–æ–¥ –Ω–µ–∫—Ä–∞—Å–∏–≤—ã–π, –Ω—É –∏ –ª–∞–¥–Ω–æ,
                –ø–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—É—é –∑–∞–¥–∞—á—É —Ä–µ—à–∞–µ—Ç) #}
                    <table style="table-layout: fixed;">
                        <tr>
                            <td colspan=2>
                                <table>
                                    <tbody>
                                    <tr>
                                        <td>
                                            <h2 style="margin-top: 0;{% if not row['Actuality'] %}text-decoration: line-through;{% endif %}">
                                                {% if user_id %}
                                                    {% if int(row['Like'])==0 %}
                                                        <form>
                                                            {{ row['BrandName'] + ' ' + row['ModelName'] + ', ' + str(int(row['ReleaseDate'])) }}
                                                            <input type="hidden" name="favourites"
                                                                   value={{ int(round(row['IDSelling'])) }}>
                                                            <input type="submit" style="color: darkgray ;"
                                                                   class="star" value="‚òÖ">
                                                            <span style="float: right; margin-top: 0;">{{ str(int(row['Price'])) + ' ‚ÇΩ' }}</span>


                                                        </form>
                                                    {% else %}
                                                        <form>
                                                            {{ row['BrandName'] + ' ' + row['ModelName'] + ', ' + str(int(row['ReleaseDate'])) }}
                                                            <input type="hidden" name="favourites"
                                                                   value={{ int(round(row['IDSelling'])) }}>
                                                            <input type="submit" style="color: #db001a ;"
                                                                   class="star"
                                                                   value="‚òÖ">
                                                            <span style="float: right; margin-top: 0;">{{ str(int(row['Price'])) + ' ‚ÇΩ' }}</span>

                                                        </form>
                                                    {% endif %}
                                                {% else %}
                                                    {{ row['BrandName'] + ' ' + row['ModelName'] + ', ' + str(int(row['ReleaseDate'])) }}
                                                    <span style="float: right; margin-top: 0;">{{ str(int(row['Price'])) + ' ‚ÇΩ' }}</span>

                                                {% endif %}
                                            </h2>
                                        </td>
                                    </tr>
                                    </tbody>
                                </table>
                            </td>
                        </tr>
                        <tr style="vertical-align: top;">
                            <td>
                                <table>
                                    <tbody>
                                    <tr>
                                        <td>
                                            <p style="color: gray;">–î–≤–∏–≥–∞—Ç–µ–ª—å</p>
                                        </td>
                                        <td>
                                            <p style="margin-top: 0;">{{ row['IDEngine'] + ', ' + row['FuelType'] + ', ' + str(row['Capacity']) + ' –ª' }}</p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p style="color: gray;">–ú–æ—â–Ω–æ—Å—Ç—å</p>
                                        </td>
                                        <td>
                                            <p style="margin-top: 0;">{{ str(int(row['HP'])) + ' –ª.—Å.' }}</p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p style="color: gray;">–ö–æ—Ä–æ–±–∫–∞ –ø–µ—Ä–µ–¥–∞—á</p>
                                        </td>
                                        <td>
                                            <p style="margin-top: 0;">{{ row['TransmissionType'] }}</p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p style="color: gray;">–ü—Ä–∏–≤–æ–¥</p>
                                        </td>
                                        <td>
                                            <p style="margin-top: 0;">{{ row['DriveType'] }}</p>
                                        </td>
                                    </tr>

                                    <tr>
                                        <td>
                                            <p style="color: gray;">VIN / –ù–æ–º–µ—Ä –∫—É–∑–æ–≤–∞:</p>
                                        </td>
                                        <td>
                                            <p style="margin-top: 0;">{{ row['BodyOrVinNumber'] }}</p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p style="color: gray;">–ì–æ—Å. –Ω–æ–º–µ—Ä</p>
                                        </td>
                                        <td>
                                            <p style="margin-top: 0;">{{ row['StateNumber'] }}</p>
                                        </td>
                                    </tr>
                                    </tbody>
                                </table>
                            </td>
                            <td>
                                <table>
                                    <tr>
                                        <td rowspan=0
                                            style="vertical-align: top; width: 50%; padding-right: 0; padding-left: 50px;">
                                            <p style="margin-top: 0; text-align: left; white-space: pre-wrap;"><span
                                                    style="color: gray;">–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ: </span>{{ row['Description'] }}
                                            </p>
                                            <p><span style="color: gray;">–ì–æ—Ä–æ–¥: </span>{{ row['CityName'] }}</p>
                                            <p style="color: gray;">–û–±—ä—è–≤–ª–µ–Ω–∏–µ {{ int(row['IDSelling']) }}
                                                –æ—Ç {{ row['AdditionDate'] }} üëÅ: {{ int(row['likes_count']) }} </p>
                                            {% if not row['Actuality'] %}
                                                <h3 style="margin-bottom: 5px;">–ê–≤—Ç–æ–º–æ–±–∏–ª—å —Å–Ω—è—Ç —Å –ø—Ä–æ–¥–∞–∂–∏</h3>
                                                <p>–ö–æ–Ω—Ç–∞–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∑–∞–∫—Ä—ã—Ç—ã</p>
                                            {% elif not user_id %}
                                                <p style="color: gray; margin-top: 19px;">–ö–æ–Ω—Ç–∞–∫—Ç–Ω—ã–π –Ω–æ–º–µ—Ä
                                                    –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω –¥–ª—è –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</p>
                                                <a href={{ url_for('login') }}>–ê–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è</a>
                                            {% else %}
                                                <p style="margin-top: 19px;"><span
                                                        style="color: gray;">–ö–æ–Ω—Ç–∞–∫—Ç–Ω—ã–π –Ω–æ–º–µ—Ä: </span>{{ row['PhoneNumber'] }}
                                                </p>
                                            {% endif %}
                                            {% if row['IDUser']==user_id %}
                                                {% if row['Actuality'] %}
                                                    <form>
                                                        <input type="hidden" name="remove" value={{ row['IDSelling'] }}>
                                                        <input class="lil_button" type="submit"
                                                               value="–£–¥–∞–ª–∏—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏–µ">
                                                    </form>
                                                {% else %}
                                                    <form>
                                                        <input type="hidden" name="restore"
                                                               value={{ row['IDSelling'] }}>
                                                        <input class="lil_button" type="submit"
                                                               value="–í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏–µ">
                                                    </form>
                                                {% endif %}
                                            {% endif %}
                                        </td>
                                    </tr>
                                </table>
                            </td>
                        </tr>
                    </table>
                </div>
            {% endfor %}
        {% else %}
            <div class="selling" style="background-color: lightgoldenrodyellow; width: fit-content;">
                –ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, –ø–æ –∑–∞–¥–∞–Ω–Ω—ã–º —É—Å–ª–æ–≤–∏—è–º –Ω–µ –Ω–∞–π–¥–µ–Ω–æ –Ω–∏ –æ–¥–Ω–æ–≥–æ –æ–±—ä—è–≤–ª–µ–Ω–∏—è.<br>
                –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å —É—Å–ª–æ–≤–∏—è –ø–æ–∏—Å–∫–∞...
            </div>
        {% endif %}
    </div>
    <footer>
        <div class="footer-left-all">
            <div class="footer-left" style="  margin-right: 36px;">
                <span class="phone-number">+7 (914) 798-29-55</span>
                <span class="name">–°–∞–∑–æ–Ω—Ç–æ–≤–∞ –ú–∞—Ä–∏—è –î–º–∏—Ç—Ä–∏–µ–≤–Ω–∞</span>
            </div>
            <div class="footer-left">
                <span class="phone-number">+7 (914) 798-19-03</span>
                <span class="name">–î—É–¥–∫–æ –î–µ–Ω–∏—Å –û–ª–µ–≥–æ–≤–∏—á</span>

            </div>
        </div>
        <div class="footer-right">
            <span class="copyright">&copy;2023 –¢–∏–ø–∞ –¥—Ä–æ–º–∞</span>
        </div>
    </footer>
</div>
<script>


</script>

</body>
</html>